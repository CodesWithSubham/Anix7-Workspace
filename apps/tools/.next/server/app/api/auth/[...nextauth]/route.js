(()=>{var e={};e.id=1014,e.ids=[1014],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},15946:()=>{},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{"use strict";e.exports=require("crypto")},55698:()=>{},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},88980:(e,r,a)=>{"use strict";a.d(r,{fG:()=>w,LO:()=>h,j2:()=>g});var t=a(50378),s=a(24613),i=a(15566),o=a(92430),n=a(25348);let l=process.env.AUTH_SECRET,u=process.env.BASE_URL,c=process.env.OWNER_EMAIL,d=["subhamduary11@gmail.com","no-reply.tools@anix7.in","contact.tools@anix7.in","contactme5950@gmail.com"];async function p(e){try{let r=await fetch(`${u}/api/admin/FromAuthjs/getUserByEmail`,{method:"POST",headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"},body:JSON.stringify({email:e})});if(!r.ok){let e=await r.json();throw console.error("Error:",e.message),Error("Failed to fetch user")}return(await r.json()).user||null}catch(e){throw console.error("Network error in getUserFromDb:",e),Error("Server error")}}async function m(e){try{let r=await fetch(`${u}/api/admin/FromAuthjs/createUser`,{method:"POST",headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"},body:JSON.stringify({userDetails:e})});if(!r.ok){let e=await r.json();return console.error("Error:",e.message),!1}return!0}catch(e){return console.error("Network error in createUser:",e),!1}}let f={pages:{signIn:"/"},providers:[(0,t.A)({name:"Credentials",id:"credentials",credentials:{email:{label:"Email",type:"text"},password:{label:"Password",type:"password"}},async authorize(e){if(!e)return null;try{let{email:r,password:a}=await o.a.parseAsync(e),t=await p(r);if(!t||!await (0,i.UD)(a,t.password))return null;let{userId:s,firstName:n,lastName:l,isVerified:u,profilePic:c,balance:d,referredBy:m}=t;return{userId:s,email:r,firstName:n,lastName:l,isVerified:u,profilePic:c,balance:d,referredBy:m}}catch(e){return null}}}),(0,s.A)({authorization:{params:{prompt:"consent",access_type:"offline",response_type:"code"}}})],callbacks:{async signIn({user:e,account:r,profile:a}){try{if("google"===r.provider){if(!e?.email)return!1;if(!await p(e.email)){let r=await (0,n.UL)(),t=r.get("referral_id")?.value||null;return await m({firstName:e.name,lastName:null,email:e.email,isVerified:a?.email_verified||!1,profilePic:e.image,referredBy:t})}}return!0}catch(e){return console.error("Unexpected error in signIn callback:",e),!1}},async jwt({token:e,user:r,account:a,profile:t}){if(r&&a){var s;let t=r.userId?r:await p(e.email);e.userId=t?.userId,e.firstName=t?.firstName,e.lastName=t?.lastName,e.isVerified=t?.isVerified,e.profilePic=t?.profilePic,e.balance=t?.balance,e.referredBy=t?.referredBy,e.loggedBy=a?.provider,e.role=(s=t.email)===c?"owner":d.includes(s)?"admin":"user"}return e},session:({session:e,token:r})=>(r&&(e.user.userId=r.userId,e.user.firstName=r.firstName,e.user.lastName=r.lastName,e.user.isVerified=r.isVerified,e.user.profilePic=r.profilePic,e.loggedBy=r.loggedBy,e.user.role=r.role),e)}},{handlers:{GET:w,POST:h},auth:g,signIn:x,signOut:y}=(0,a(83010).Ay)({session:{strategy:"jwt"},...f})},92430:(e,r,a)=>{"use strict";a.d(r,{O:()=>i,a:()=>s});var t=a(31825);let s=(0,t.Ik)({email:(0,t.Yj)().email("Invalid email address.").transform(e=>e.toLowerCase().replace(/\+.*(?=@)/,"")),password:(0,t.Yj)().min(1,"Password is required").max(32,"Entered password is too long")}),i=(0,t.Ik)({firstName:(0,t.Yj)().min(1,"First name is required.").max(48,"First name must be less than 48 characters."),lastName:(0,t.Yj)().max(48,"Last name must be less than 48 characters.").optional(),email:(0,t.Yj)().email("Invalid email address.").transform(e=>e.toLowerCase().replace(/\+.*(?=@)/,"")),password:(0,t.Yj)().min(1,"Please enter a password.").min(8,"Password must be at least 8 characters long.").max(32,"Password must be less than 32 characters long.").regex(/[A-Z]/,"Password must contain at least one uppercase letter.").regex(/[a-z]/,"Password must contain at least one lowercase letter.").regex(/\d/,"Password must contain at least one number.").regex(/[!@#$%^&*(),.?":{}|<>]/,"Password must contain at least one special character."),confirmPassword:(0,t.Yj)(),isVerified:(0,t.zM)().optional().default(!1),profilePic:(0,t.Yj)().url("Invalid URL.").optional().nullable(),balance:(0,t.ai)().optional().default(0),referredBy:(0,t.Yj)().optional().nullable()}).refine(e=>e.password===e.confirmPassword,{message:"Passwords do not match.",path:["confirmPassword"]})},92920:(e,r,a)=>{"use strict";a.r(r),a.d(r,{patchFetch:()=>d,routeModule:()=>n,serverHooks:()=>c,workAsyncStorage:()=>l,workUnitAsyncStorage:()=>u});var t={};a.r(t);var s=a(53358),i=a(24967),o=a(47614);a(88980);let n=new s.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/auth/[...nextauth]/route",pathname:"/api/auth/[...nextauth]",filename:"route",bundlePath:"app/api/auth/[...nextauth]/route"},resolvedPagePath:"C:\\Users\\subha\\Projects\\Anix7 Workspace\\apps\\tools\\app\\api\\auth\\[...nextauth]\\route.js",nextConfigOutput:"",userland:t}),{workAsyncStorage:l,workUnitAsyncStorage:u,serverHooks:c}=n;function d(){return(0,o.patchFetch)({workAsyncStorage:l,workUnitAsyncStorage:u})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var a=e=>r(r.s=e),t=r.X(0,[7614,3532,7929,7792,4608,5646],()=>a(92920));module.exports=t})();