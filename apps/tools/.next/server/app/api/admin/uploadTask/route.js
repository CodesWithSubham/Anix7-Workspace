(()=>{var e={};e.id=7209,e.ids=[7209],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4544:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(e,t)=>{if(void 0!==t&&(!Array.isArray(t)||t.some(e=>"string"!=typeof e)))throw TypeError(`"${e}" option must be an array of strings`);if(t)return new Set(t)}},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12518:e=>{"use strict";e.exports=require("mongodb")},15946:()=>{},16289:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var a=r(71528),o=r(781);let n=async(e,t,r)=>{if(t instanceof Uint8Array){if(!e.startsWith("HS"))throw TypeError((0,o.A)(t,"CryptoKey","KeyObject","JSON Web Key"));return crypto.subtle.importKey("raw",t,{hash:`SHA-${e.slice(-3)}`,name:"HMAC"},!1,[r])}return(0,a.Y)(t,e,r),t}},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44746:(e,t,r)=>{"use strict";r.d(t,{V:()=>S});var a=r(32056),o=r(83243),n=r(12388),s=r(16289);let i=async(e,t,r,a)=>{let i=await (0,s.A)(e,t,"verify");(0,n.A)(e,i);let d=(0,o.A)(e,i.algorithm);try{return await crypto.subtle.verify(d,i,r,a)}catch{return!1}};var d=r(19967),c=r(70745),l=r(68200),p=r(96871),u=r(6580),y=r(26474),f=r(4544),h=r(25994);async function w(e,t,r){let o,n;if(!(0,p.A)(e))throw new d.Ye("Flattened JWS must be an object");if(void 0===e.protected&&void 0===e.header)throw new d.Ye('Flattened JWS must have either of the "protected" or "header" members');if(void 0!==e.protected&&"string"!=typeof e.protected)throw new d.Ye("JWS Protected Header incorrect type");if(void 0===e.payload)throw new d.Ye("JWS Payload missing");if("string"!=typeof e.signature)throw new d.Ye("JWS Signature missing or incorrect type");if(void 0!==e.header&&!(0,p.A)(e.header))throw new d.Ye("JWS Unprotected Header incorrect type");let s={};if(e.protected)try{let t=(0,a.D)(e.protected);s=JSON.parse(c.D0.decode(t))}catch{throw new d.Ye("JWS Protected Header is invalid")}if(!(0,l.A)(s,e.header))throw new d.Ye("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let w={...s,...e.header},m=(0,y.A)(d.Ye,new Map([["b64",!0]]),r?.crit,s,w),g=!0;if(m.has("b64")&&"boolean"!=typeof(g=s.b64))throw new d.Ye('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:S}=w;if("string"!=typeof S||!S)throw new d.Ye('JWS "alg" (Algorithm) Header Parameter missing or invalid');let v=r&&(0,f.A)("algorithms",r.algorithms);if(v&&!v.has(S))throw new d.Rb('"alg" (Algorithm) Header Parameter value not allowed');if(g){if("string"!=typeof e.payload)throw new d.Ye("JWS Payload must be a string")}else if("string"!=typeof e.payload&&!(e.payload instanceof Uint8Array))throw new d.Ye("JWS Payload must be a string or an Uint8Array instance");let A=!1;"function"==typeof t&&(t=await t(s,e),A=!0),(0,u.A)(S,t,"verify");let b=(0,c.xW)(c.Rd.encode(e.protected??""),c.Rd.encode("."),"string"==typeof e.payload?c.Rd.encode(e.payload):e.payload);try{o=(0,a.D)(e.signature)}catch{throw new d.Ye("Failed to base64url decode the signature")}let x=await (0,h.A)(t,S);if(!await i(S,x,o,b))throw new d.h2;if(g)try{n=(0,a.D)(e.payload)}catch{throw new d.Ye("Failed to base64url decode the payload")}else n="string"==typeof e.payload?c.Rd.encode(e.payload):e.payload;let R={payload:n};return(void 0!==e.protected&&(R.protectedHeader=s),void 0!==e.header&&(R.unprotectedHeader=e.header),A)?{...R,key:x}:R}async function m(e,t,r){if(e instanceof Uint8Array&&(e=c.D0.decode(e)),"string"!=typeof e)throw new d.Ye("Compact JWS must be a string or Uint8Array");let{0:a,1:o,2:n,length:s}=e.split(".");if(3!==s)throw new d.Ye("Invalid Compact JWS");let i=await w({payload:o,protected:a,signature:n},t,r),l={payload:i.payload,protectedHeader:i.protectedHeader};return"function"==typeof t?{...l,key:i.key}:l}var g=r(76415);async function S(e,t,r){let a=await m(e,t,r);if(a.protectedHeader.crit?.includes("b64")&&!1===a.protectedHeader.b64)throw new d.Dp("JWTs MUST NOT use unencoded payload");let o={payload:(0,g.k)(a.protectedHeader,a.payload,r),protectedHeader:a.protectedHeader};return"function"==typeof t?{...o,key:a.key}:o}},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{"use strict";e.exports=require("crypto")},55698:()=>{},56041:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var a=r(12518);let o=process.env.MONGODB_URI;if(!process.env.MONGODB_URI)throw Error("Add MongoDB URI to your .env.local file.");let n=new a.MongoClient(o).connect()},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},63817:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>b,routeModule:()=>g,serverHooks:()=>A,workAsyncStorage:()=>S,workUnitAsyncStorage:()=>v});var a={};r.r(a),r.d(a,{POST:()=>m});var o=r(53358),n=r(24967),s=r(47614),i=r(44746),d=r(8527),c=r(56041),l=r(55511);let p={randomUUID:l.randomUUID},u=new Uint8Array(256),y=u.length,f=[];for(let e=0;e<256;++e)f.push((e+256).toString(16).slice(1));let h=function(e,t,r){if(p.randomUUID&&!t&&!e)return p.randomUUID();let a=(e=e||{}).random??e.rng?.()??(y>u.length-16&&((0,l.randomFillSync)(u),y=0),u.slice(y,y+=16));if(a.length<16)throw Error("Random bytes length must be >= 16");if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){if((r=r||0)<0||r+16>t.length)throw RangeError(`UUID byte range ${r}:${r+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[r+e]=a[e];return t}return function(e,t=0){return(f[e[t+0]]+f[e[t+1]]+f[e[t+2]]+f[e[t+3]]+"-"+f[e[t+4]]+f[e[t+5]]+"-"+f[e[t+6]]+f[e[t+7]]+"-"+f[e[t+8]]+f[e[t+9]]+"-"+f[e[t+10]]+f[e[t+11]]+f[e[t+12]]+f[e[t+13]]+f[e[t+14]]+f[e[t+15]]).toLowerCase()}(a)};var w=r(66081);async function m(e){try{let t=e.cookies.get("adminToken")?.value;if(!t)return d.NextResponse.json({error:"Unauthorized"},{status:401});let r=new TextEncoder().encode(process.env.JWT_SECRET);try{let{payload:e}=await (0,i.V)(t,r);if("admin"!==e.role)return d.NextResponse.json({error:"Forbidden"},{status:403})}catch(e){return console.log("Error"+e),d.NextResponse.json({error:"Invalid or expired token"},{status:401})}let a=await e.formData(),o=a.get("image"),n=a.get("title"),s=a.get("taskCat"),l=a.get("desc"),p=a.get("url");if(!o||!n||!s||!l||!p)return d.NextResponse.json({error:"All fields are required."},{status:400});Buffer.from(await o.arrayBuffer()),o.name,o.type;let u=await (0,w.O)("sendPhoto",{chat_id:process.env.TELEGRAM_STORAGE_CHANNEL,caption:`Uploaded file: ${o.name}`,photo:o}),y=u?.photo?.at(-1)?.file_id,f=`/api/tg/image/${y}`,m=(await c.A).db().collection("tasks"),g={id:h(),title:n,taskCat:s,desc:l,url:p,image:f,createdAt:new Date};if(!(await m.insertOne(g)).acknowledged)return d.NextResponse.json({error:"Failed to save task to database."},{status:500});return d.NextResponse.json({success:!0,message:"Task uploaded successfully.",taskData:g})}catch(e){return console.error("Error:",e),d.NextResponse.json({error:"Failed to process the request."},{status:500})}}let g=new o.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/admin/uploadTask/route",pathname:"/api/admin/uploadTask",filename:"route",bundlePath:"app/api/admin/uploadTask/route"},resolvedPagePath:"C:\\Users\\subha\\Projects\\Anix7 Workspace\\apps\\tools\\app\\api\\admin\\uploadTask\\route.js",nextConfigOutput:"",userland:a}),{workAsyncStorage:S,workUnitAsyncStorage:v,serverHooks:A}=g;function b(){return(0,s.patchFetch)({workAsyncStorage:S,workUnitAsyncStorage:v})}},66081:(e,t,r)=>{"use strict";r.d(t,{O:()=>n});let a=process.env.TELEGRAM_BOT_TOKEN;if(!a)throw Error("BOT_TOKEN is not defined in the environment variables");let o=`https://api.telegram.org/bot${a}`,n=async(e,t={})=>{let r=new FormData;for(let[e,a]of Object.entries(t))r.append(e,a);let a=await fetch(`${o}/${e}`,{method:"POST",body:r});if(!a.ok){let e=await a.json();throw Error(`Telegram API error: ${e.description}`)}return(await a.json()).result}},83243:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var a=r(19967);let o=(e,t)=>{let r=`SHA-${e.slice(-3)}`;switch(e){case"HS256":case"HS384":case"HS512":return{hash:r,name:"HMAC"};case"PS256":case"PS384":case"PS512":return{hash:r,name:"RSA-PSS",saltLength:parseInt(e.slice(-3),10)>>3};case"RS256":case"RS384":case"RS512":return{hash:r,name:"RSASSA-PKCS1-v1_5"};case"ES256":case"ES384":case"ES512":return{hash:r,name:"ECDSA",namedCurve:t.namedCurve};case"Ed25519":case"EdDSA":return{name:"Ed25519"};default:throw new a.T0(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[7614,3532,7929],()=>r(63817));module.exports=a})();